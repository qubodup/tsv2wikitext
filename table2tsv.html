<!DOCTYPE html>
<html>
  <head><title>WYSIWYG HTML Table to TSV</title></head>
<body>
<div contenteditable="true" id="input" style="border:1px solid black;height:200px;overflow:auto;"></div>
<button onclick="convert()">Convert</button>
<textarea id="output" style="width:100%;height:200px;" onclick="this.select()"></textarea>
<script>
function convert() {
  const html = document.getElementById("input").innerHTML;
  const doc = new DOMParser().parseFromString(html, "text/html");
  const tables = doc.querySelectorAll("table");
  let result = [];

  tables.forEach(table => {
    const rows = table.rows;
    for (let i = 0; i < rows.length; i++) {
      let row = [];
      for (let j = 0; j < rows[i].cells.length; j++) {
        let cell = rows[i].cells[j];
        const a = cell.querySelector("a");
        if (a) {
          row.push(a.textContent.trim());
          row.push(a.href.split(" ")[0]);
        } else {
          row.push(cell.textContent.trim());
        }
      }
      result.push(row.join("\t"));
    }
  });

  document.getElementById("output").value = result.join("\n");
}
</script>
</body>
</html>
